package com.minkang.ultimate.titles;
import org.bukkit.*; import org.bukkit.entity.Player; import org.bukkit.event.*; import org.bukkit.event.inventory.*; import org.bukkit.inventory.*; import org.bukkit.inventory.meta.*;
public class ColorChatGUIListener implements Listener { private final Main plugin; private final ColorChatService service;
public ColorChatGUIListener(Main plugin, ColorChatService s){ this.plugin=plugin; this.service=s; }
@EventHandler public void onClick(InventoryClickEvent e){ if(!(e.getWhoClicked() instanceof Player)) return; Player p=(Player)e.getWhoClicked(); String guiTitle=Chat.color(plugin.getConfig().getString("colorchat.gui.title","&8색깔채팅")); if(!e.getView().getTitle().equals(Chat.color(guiTitle))) return; e.setCancelled(true); ItemStack it=e.getCurrentItem(); if(it==null || it.getType()==Material.AIR || !it.hasItemMeta()) return; ItemMeta im=it.getItemMeta(); if(!im.hasDisplayName()) return; String name=Chat.color(im.getDisplayName()); String resetName=Chat.color(plugin.getConfig().getString("colorchat.gui.reset_button.name","&7[원래대로] 색깔 해제")); if(name.equals(resetName)){ service.setActive(p.getUniqueId(), null); p.sendMessage(Chat.color(plugin.msg("prefix")+plugin.msg("colorchat.cleared"))); return; } for(ColorDef def: service.all()){ String defNameColored=Chat.color(def.code+def.name); if(name.equals(defNameColored)){ if(plugin.storage().get(p.getUniqueId()).getColorsOwned().contains(def.id.toLowerCase())){ service.setActive(p.getUniqueId(), def.id); p.sendMessage(Chat.color(plugin.msg("prefix")+plugin.msg("colorchat.applied").replace("{color_name}", defNameColored))); } return; } } }
}